{$DOMAIN:localhost:80}{$CADDY_PORT} {
    @id
	handle /api/* {
		reverse_proxy {$PRIVATE_BACKEND_URL:localhost:8000}
	}

	handle /ws/* {
		reverse_proxy {$PRIVATE_BACKEND_URL:localhost:8000}
	}

	respond /caddy-health-check 200

	handle_path /media/* {
		@downloads {
			query dl=*
		}
		header @downloads Content-disposition "attachment; filename={query.dl}"

		file_server {
			root {$MEDIA_ROOT:/baserow/media/}
		}
	}

	reverse_proxy {$PRIVATE_WEBFRONTEND_URL:localhost:3000}
}
